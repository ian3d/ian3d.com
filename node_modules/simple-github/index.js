/**
 * @author Ian Hunter
 * Simple node to grab github projects using the API
 *
 */

'use strict'
var https = require('https');

module.exports = function(username, cb) {

    var options = {
        host: 'api.github.com',
        path: '/users/' + username + '/repos',
        headers: {
            'Accept': 'application/vnd.github.v3+json',
            'User-Agent': 'ian3d.com'
        }
    }

    https.get(options, function(gitHubRes) {

        var bodyChunks = [];
        gitHubRes.on('data', function(chunk) {
            bodyChunks.push(chunk);
        }).on('end', function() {
            var body = Buffer.concat(bodyChunks);
            console.log('done getting github data');
            cb(null, JSON.parse(body));
        })
    }).on('error', function(e) {
        console.log('ERROR: ' + e.message);
        return cb(e, 'Failed to find user');
    });
}